{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "height":450,
    "width":"container",
    "title": "The Top 6 Languages Spoken in Australia by State",
    "description": "Stacked bar chart showing number of speakers per language, segmented by state.",
    "data": {
        "url": "https://raw.githubusercontent.com/mkee0011/3179/main/Homework_Week_10/data/top6lanp_bystate.csv"
    },
    "params":[
        {
            "name":"speakers_above",
            "value":0,
            "bind": {
                "input":"range",
                "min":0,
                "max":270000,
                "step": 10000,
                "name": "Minimum Number of Speakers: "
            }
        },
        {
            "name":"state_select",
            "bind":{
                "input":"select",
                "options":[
                    null,
                    "New South Wales",
                    "Victoria",
                    "Queensland",
                    "Australian Capital Territory",
                    "Northern Territory",
                    "Tasmania",
                    "Western Australia",
                    "South Australia"
                ],
                "labels":[
                    "Show All",
                    "New South Wales",
                    "Victoria",
                    "Queensland",
                    "Australian Capital Territory",
                    "Northern Territory",
                    "Tasmania",
                    "Western Australia",
                    "South Australia"
                ],
                "name": "State: "
            }
        }
    ],
    "transform": [
        {"filter":"datum.Speakers > speakers_above"},
        {"filter":"!state_select||datum.State == state_select"}
    ],
    "layer":[
        {
            "mark":"bar",
            "encoding": {
                "x": {
                    "field": "Language",
                    "type": "nominal",
                    "axis": {"title": "Language", "labelAngle": -45},
                    "sort": "ascending"
                },
                "y": {
                    "field": "Speakers",
                    "type": "quantitative",
                    "axis": {"title": "Number of Speakers"}
                },
            "color": {
                "field": "State",
                "type": "nominal",
                "scale":{
                "domain":[
                    "New South Wales",
                    "Victoria",
                    "Queensland",
                    "Australian Capital Territory",
                    "Northern Territory",
                    "Tasmania",
                    "Western Australia",
                    "South Australia"
                ],
                "range":[
                    "#8dd3c7",
                    "#bebada",
                    "#ffffb3",
                    "#fb8072",
                    "#80b1d3",
                    "#fdb462",
                    "#b3de69",
                    "#fccde5"
                ]
            }
        },
        "tooltip":[
            {"field":"State", "type": "nominal"},
            {"field":"Speakers","type": "quantitative","title":"Number of Speakers"}
        ]
        }
        },
        {
            "mark":{
                "type":"text",
                "align":"center",
                "baseline":"middle",
                "dx":-1,
                "fontSize":11.5,
                "fontStyle":"italic"

            },
            "encoding": {
                "x": {
                    "field": "Language",
                    "type": "nominal",
                    "axis": {"title": "Language", "labelAngle": -45},
                    "sort": "ascending"
                },
                "y": {
                    "field": "Speakers",
                    "type": "quantitative",
                    "axis": {"title": "Number of Speakers"}
                },
                "text":{"field":"Language","type":"nominal"},
                "color":{"value":"black"},
                "opacity":{
                    "condition":{
                        "test":"datum.State == 'New South Wales' && datum.Language == 'Mandarin'",
                        "value":1
                    },
                    "value":0
                },
                "tooltip":[
                    {"field":"State", "type": "nominal"},
                    {"field":"Speakers","type": "quantitative","title":"Number of Speakers"}
                ]
            }
        }
    ]
}